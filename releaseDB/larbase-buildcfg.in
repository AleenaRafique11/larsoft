# build everything except larsoft itself

basequal=${1}

build_bundle nu-@NUTOOLS_DOT_VERSION@ ${basequal}
status=$?
if (( ${status} != 0)); then
  cat 1>&2 <<EOF
Build of nu-@NUTOOLS_DOT_VERSION@ bundle failed with status ${status}
EOF
  return ${status}
fi

# cmake 3.3.2 and cetbuildtools v4_14_01
do_build cmake v3_3_2
ensure_cetbuildtools v4_14_01 v4_14_02

build_cet -p artdaq-core artdaq_core @ARTDAQ_CORE_VERSION@ ${basequal}:nu${version_set:+\:${version_set}}

build_cet artextensions @ARTEXTENSIONS_VERSION@ ${basequal}:nu${version_set:+\:${version_set}}

do_build pandora @PANDORA_VERSION@ nu:${basequal}
do_build larpandoracontent @LARPANDORACONTENT_VERSION@ nu:${basequal}

# add to manifest if no build - larsoft_data, mrb
prep_build larsoft_data @LARSOFT_DATA_VERSION@; add_to_manifest
prep_build mrb @MRB_VERSION@; add_to_manifest

return 0
